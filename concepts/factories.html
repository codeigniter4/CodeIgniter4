<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Factories &mdash; CodeIgniter 4.6.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/citheme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/citheme_dark.css" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/js/citheme.js"></script>
        <script src="../_static/js/carbon.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with HTTP Requests" href="http.html" />
    <link rel="prev" title="Services" href="services.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/ci-logo-text.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Welcome to CodeIgniter4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/index.html">Welcome to CodeIgniter4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/requirements.html">Server Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/credits.html">Credits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/psr.html">PSR Compliance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../license.html">License Agreement</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_composer.html">Composer Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_manual.html">Manual Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/running.html">Running Your App</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/deployment.html">Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelogs/index.html">Change Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/upgrading.html">Upgrading From a Previous Version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/repositories.html">CodeIgniter Repositories</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Build Your First Application</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/static_pages.html">Static Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/news_section.html">News Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/create_news_items.html">Create News Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/conclusion.html">Conclusion</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">CodeIgniter4 Overview</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="structure.html">Application Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="mvc.html">Models, Views, and Controllers</a></li>
<li class="toctree-l2"><a class="reference internal" href="autoloader.html">Autoloading Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="services.html">Services</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Factories</a></li>
<li class="toctree-l2"><a class="reference internal" href="http.html">Working with HTTP Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">Security Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals.html">Design and Architectural Goals</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/index.html">General Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../general/configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/urls.html">CodeIgniter URLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/helpers.html">Helper Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/common_functions.html">Global Functions and Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/logging.html">Logging Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/errors.html">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/caching.html">Web Page Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/ajax.html">AJAX Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/modules.html">Code Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/managing_apps.html">Managing your Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/environments.html">Handling Multiple Environments</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../incoming/index.html">Controllers and Routing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../incoming/routing.html">URI Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/controllers.html">Controllers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/filters.html">Controller Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/auto_routing_improved.html">Auto Routing (Improved)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/message.html">HTTP Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/request.html">Request Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/incomingrequest.html">IncomingRequest Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/content_negotiation.html">Content Negotiation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/methodspoofing.html">HTTP Method Spoofing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/restful.html">RESTful Resource Handling</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../outgoing/index.html">Building Responses</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/views.html">Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_renderer.html">View Renderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_layouts.html">View Layouts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_cells.html">View Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_parser.html">View Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_decorators.html">View Decorators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/table.html">HTML Table Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/response.html">HTTP Responses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/api_responses.html">API Response Trait</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/csp.html">Content Security Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/localization.html">Localization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/alternative_php.html">Alternate PHP Syntax for View Files</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../database/index.html">Working with Databases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../database/examples.html">Quick Start: Usage Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/configuration.html">Database Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/connecting.html">Connecting to a Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/queries.html">Running Queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/results.html">Generating Query Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/helpers.html">Query Helper Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/query_builder.html">Query Builder Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/transactions.html">Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/metadata.html">Getting Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/call_function.html">Custom Function Calls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/events.html">Database Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/utilities.html">Database Utilities</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">Modeling Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/model.html">Using CodeIgniter's Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/entities.html">Using Entity Classes</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dbmgmt/index.html">Managing Databases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/forge.html">Database Forge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/migration.html">Database Migrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/seeds.html">Database Seeding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/db_commands.html">Database Commands</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../libraries/index.html">Library Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../libraries/caching.html">Caching Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/cookies.html">Cookies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/cors.html">Cross-Origin Resource Sharing (CORS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/curlrequest.html">CURLRequest Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/email.html">Email Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/encryption.html">Encryption Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/files.html">Working with Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/file_collections.html">File Collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/honeypot.html">Honeypot Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/images.html">Image Manipulation Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/pagination.html">Pagination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/publisher.html">Publisher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/security.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/sessions.html">Session Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/throttler.html">Throttler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/time.html">Times and Dates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/typography.html">Typography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/uploaded_files.html">Working with Uploaded Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/uri.html">Working with URIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/user_agent.html">User Agent Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/validation.html">Validation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../helpers/index.html">Helpers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../helpers/array_helper.html">Array Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/cookie_helper.html">Cookie Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/date_helper.html">Date Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/filesystem_helper.html">Filesystem Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/form_helper.html">Form Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/html_helper.html">HTML Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/inflector_helper.html">Inflector Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/number_helper.html">Number Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/security_helper.html">Security Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/test_helper.html">Test Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/text_helper.html">Text Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/url_helper.html">URL Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/xml_helper.html">XML Helper</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing/overview.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/database.html">Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/fabricator.html">Generating Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/controllers.html">Controller Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/feature.html">HTTP Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/response.html">Testing Responses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/cli.html">Testing CLI Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/mocking.html">Mocking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/benchmark.html">Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/debugging.html">Debugging Your Application</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">Command Line Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_overview.html">CLI Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_controllers.html">Running Controllers via CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/spark_commands.html">Spark Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_commands.html">Creating Spark Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_generators.html">CLI Generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_library.html">CLI Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_request.html">CLIRequest Class</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extending/index.html">Extending CodeIgniter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extending/core_classes.html">Creating Core System Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/common.html">Replacing Common Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/events.html">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/basecontroller.html">Extending the Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/authentication.html">Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/composer_packages.html">Creating Composer Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/contributing.html">Contributing to CodeIgniter</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../libraries/official_packages.html">Official Packages</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CodeIgniter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
<a class="btn btn-neutral float-right" href="https://github.com/codeigniter4/CodeIgniter4/edit/develop/user_guide_src/source/concepts/factories.rst">Edit this page</a>

          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">CodeIgniter4 Overview</a></li>
      <li class="breadcrumb-item active">Factories</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="factories">
<h1>Factories<a class="headerlink" href="#factories" title="Permalink to this heading"></a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id2">Introduction</a></p>
<ul>
<li><p><a class="reference internal" href="#what-are-factories" id="id3">What are Factories?</a></p></li>
<li><p><a class="reference internal" href="#differences-from-services" id="id4">Differences from Services</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#loading-classes" id="id5">Loading Classes</a></p>
<ul>
<li><p><a class="reference internal" href="#loading-a-class" id="id6">Loading a Class</a></p>
<ul>
<li><p><a class="reference internal" href="#passing-classname-without-namespace" id="id7">Passing Classname without Namespace</a></p></li>
<li><p><a class="reference internal" href="#passing-fully-qualified-classname" id="id8">Passing Fully Qualified Classname</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#convenience-functions" id="id9">Convenience Functions</a></p>
<ul>
<li><p><a class="reference internal" href="#config" id="id10">config()</a></p></li>
<li><p><a class="reference internal" href="#model" id="id11">model()</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#defining-classname-to-be-loaded" id="id12">Defining Classname to be Loaded</a></p></li>
<li><p><a class="reference internal" href="#factory-parameters" id="id13">Factory Parameters</a></p></li>
<li><p><a class="reference internal" href="#factories-options" id="id14">Factories Options</a></p></li>
<li><p><a class="reference internal" href="#factories-behavior" id="id15">Factories Behavior</a></p>
<ul>
<li><p><a class="reference internal" href="#configurations" id="id16">Configurations</a></p>
<ul>
<li><p><a class="reference internal" href="#example-filters-factories" id="id17">Example: Filters Factories</a></p></li>
<li><p><a class="reference internal" href="#example-library-factories" id="id18">Example: Library Factories</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#setoptions-method" id="id19">setOptions Method</a></p></li>
<li><p><a class="reference internal" href="#parameter-options" id="id20">Parameter Options</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#config-caching" id="id21">Config Caching</a></p>
<ul>
<li><p><a class="reference internal" href="#prerequisite" id="id22">Prerequisite</a></p></li>
<li><p><a class="reference internal" href="#how-it-works" id="id23">How It Works</a></p></li>
<li><p><a class="reference internal" href="#how-to-update-config-values" id="id24">How to Update Config Values</a></p></li>
<li><p><a class="reference internal" href="#how-to-enable-config-caching" id="id25">How to Enable Config Caching</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<section id="what-are-factories">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">What are Factories?</a><a class="headerlink" href="#what-are-factories" title="Permalink to this heading"></a></h3>
<p>Like <a class="reference internal" href="services.html"><span class="doc">Services</span></a>, <strong>Factories</strong> are an extension of autoloading that helps keep your code
concise yet optimal, without having to pass around object instances between classes.</p>
<p>Factories are similar to CodeIgniter 3’s <code class="docutils literal notranslate"><span class="pre">$this-&gt;load</span></code> in the following points:</p>
<ul class="simple">
<li><p>Load a class</p></li>
<li><p>Share the loaded class instance</p></li>
</ul>
<p>At its
simplest, Factories provide a common way to create a class instance and access it from
anywhere. This is a great way to reuse object states and reduce memory load from keeping
multiple instances loaded across your app.</p>
<p>Any class can be loaded by Factories, but the best examples are those classes that are used
to work on or transmit common data. The framework itself uses Factories internally, e.g., to
make sure the correct configuration is loaded when using the <code class="docutils literal notranslate"><span class="pre">Config</span></code> class.</p>
</section>
<section id="differences-from-services">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Differences from Services</a><a class="headerlink" href="#differences-from-services" title="Permalink to this heading"></a></h3>
<p>Factories require a concrete class name to instantiate and do not have code to create instances.</p>
<p>So, Factories are not good for creating a complex instance that needs many dependencies,
and you cannot change the class of the instance to be returned.</p>
<p>On the other hand, Services have code to create instances, so it can create a complex instance
that needs other services or class instances. When you get a service, Services require a service name,
not a class name, so the returned instance can be changed without changing the client code.</p>
</section>
</section>
<section id="loading-classes">
<span id="factories-loading-class"></span><h2><a class="toc-backref" href="#id5" role="doc-backlink">Loading Classes</a><a class="headerlink" href="#loading-classes" title="Permalink to this heading"></a></h2>
<section id="loading-a-class">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Loading a Class</a><a class="headerlink" href="#loading-a-class" title="Permalink to this heading"></a></h3>
<p>Take a look at <strong>Models</strong> as an example. You can access the Factory specific to Models
by using the magic static method of the Factories class, <code class="docutils literal notranslate"><span class="pre">Factories::models()</span></code>.</p>
<p>The static method name is called <em>component</em>.</p>
<section id="passing-classname-without-namespace">
<span id="factories-passing-classname-without-namespace"></span><h4><a class="toc-backref" href="#id7" role="doc-backlink">Passing Classname without Namespace</a><a class="headerlink" href="#passing-classname-without-namespace" title="Permalink to this heading"></a></h4>
<p>If you pass a classname without a namespace, Factories first searches in the
<code class="docutils literal notranslate"><span class="pre">App</span></code> namespace for the path corresponding to the magic static method name.
<code class="docutils literal notranslate"><span class="pre">Factories::models()</span></code> searches the <strong>app/Models</strong> directory.</p>
<section id="passing-short-classname">
<h5>Passing Short Classname<a class="headerlink" href="#passing-short-classname" title="Permalink to this heading"></a></h5>
<p>In the following code, if you have <code class="docutils literal notranslate"><span class="pre">App\Models\UserModel</span></code>, the instance will be returned:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\Factories</span><span class="p">;</span>

<span class="nv">$users</span> <span class="o">=</span> <span class="nx">Factories</span><span class="o">::</span><span class="na">models</span><span class="p">(</span><span class="s1">&#39;UserModel&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>If you don’t have <code class="docutils literal notranslate"><span class="pre">App\Models\UserModel</span></code>, it searches for <code class="docutils literal notranslate"><span class="pre">Models\UserModel</span></code> in all namespaces.</p>
<p>Next time you ask for the same class anywhere in your code, Factories will be sure
you get back the instance as before:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\Factories</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">SomeOtherClass</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">someFunction</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$users</span> <span class="o">=</span> <span class="nx">Factories</span><span class="o">::</span><span class="na">models</span><span class="p">(</span><span class="s1">&#39;UserModel&#39;</span><span class="p">);</span>

        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="passing-short-classname-with-sub-directories">
<h5>Passing Short Classname with Sub-directories<a class="headerlink" href="#passing-short-classname-with-sub-directories" title="Permalink to this heading"></a></h5>
<p>If you want to load a class in sub directories, you use the <code class="docutils literal notranslate"><span class="pre">/</span></code> as a separator.
The following code loads <strong>app/Libraries/Sub/SubLib.php</strong> if it exists:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">CodeIgniter\Config\Factories</span><span class="p">;</span>

<span class="nv">$lib</span> <span class="o">=</span> <span class="nx">Factories</span><span class="o">::</span><span class="na">libraries</span><span class="p">(</span><span class="s1">&#39;Sub/SubLib&#39;</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="passing-fully-qualified-classname">
<span id="factories-passing-fully-qualified-classname"></span><h4><a class="toc-backref" href="#id8" role="doc-backlink">Passing Fully Qualified Classname</a><a class="headerlink" href="#passing-fully-qualified-classname" title="Permalink to this heading"></a></h4>
<p>You could also request a fully qualified classname:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">CodeIgniter\Config\Factories</span><span class="p">;</span>

<span class="nv">$users</span> <span class="o">=</span> <span class="nx">Factories</span><span class="o">::</span><span class="na">models</span><span class="p">(</span><span class="s1">&#39;Blog\Models\UserModel&#39;</span><span class="p">);</span>
<span class="c1">// Or</span>
<span class="nv">$users</span> <span class="o">=</span> <span class="nx">Factories</span><span class="o">::</span><span class="na">models</span><span class="p">(</span><span class="nx">\Blog\Models\UserModel</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</pre></div>
</div>
<p>It returns the instance of <code class="docutils literal notranslate"><span class="pre">Blog\Models\UserModel</span></code> if it exists.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Prior to v4.4.0, when you requested a fully qualified classname,
if you had only <code class="docutils literal notranslate"><span class="pre">Blog\Models\UserModel</span></code>, the instance would be returned.
But if you had both <code class="docutils literal notranslate"><span class="pre">App\Models\UserModel</span></code> and <code class="docutils literal notranslate"><span class="pre">Blog\Models\UserModel</span></code>,
the instance of <code class="docutils literal notranslate"><span class="pre">App\Models\UserModel</span></code> would be returned.</p>
<p>If you wanted to get <code class="docutils literal notranslate"><span class="pre">Blog\Models\UserModel</span></code>, you needed to disable the
option <code class="docutils literal notranslate"><span class="pre">preferApp</span></code>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">CodeIgniter\Config\Factories</span><span class="p">;</span>

<span class="nv">$users</span> <span class="o">=</span> <span class="nx">Factories</span><span class="o">::</span><span class="na">models</span><span class="p">(</span><span class="s1">&#39;Blog\Models\UserModel&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;preferApp&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>
<section id="convenience-functions">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Convenience Functions</a><a class="headerlink" href="#convenience-functions" title="Permalink to this heading"></a></h2>
<p>Two shortcut functions for Factories have been provided. These functions are always available.</p>
<section id="config">
<span id="factories-config"></span><h3><a class="toc-backref" href="#id10" role="doc-backlink">config()</a><a class="headerlink" href="#config" title="Permalink to this heading"></a></h3>
<p>The first is <a class="reference internal" href="../general/common_functions.html#config" title="config"><code class="xref php php-func docutils literal notranslate"><span class="pre">config()</span></code></a> which returns a new instance of a Config class. The only required parameter is the class name:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$appConfig</span> <span class="o">=</span> <span class="nx">config</span><span class="p">(</span><span class="s1">&#39;App&#39;</span><span class="p">);</span>

<span class="c1">// The code above is the same as the code below.</span>
<span class="nv">$appConfig</span> <span class="o">=</span> <span class="nx">\CodeIgniter\Config\Factories</span><span class="o">::</span><span class="na">config</span><span class="p">(</span><span class="s1">&#39;App&#39;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="model">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">model()</a><a class="headerlink" href="#model" title="Permalink to this heading"></a></h3>
<p>The second function, <a class="reference internal" href="../general/common_functions.html#model" title="model"><code class="xref php php-func docutils literal notranslate"><span class="pre">model()</span></code></a> returns a new instance of a Model class. The only required parameter is the class name:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$user</span> <span class="o">=</span> <span class="nx">model</span><span class="p">(</span><span class="s1">&#39;UserModel&#39;</span><span class="p">);</span>

<span class="c1">// The code above is the same as the code below.</span>
<span class="nv">$user</span> <span class="o">=</span> <span class="nx">\CodeIgniter\Config\Factories</span><span class="o">::</span><span class="na">models</span><span class="p">(</span><span class="s1">&#39;UserModel&#39;</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="defining-classname-to-be-loaded">
<span id="factories-defining-classname-to-be-loaded"></span><h2><a class="toc-backref" href="#id12" role="doc-backlink">Defining Classname to be Loaded</a><a class="headerlink" href="#defining-classname-to-be-loaded" title="Permalink to this heading"></a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 4.4.0.</span></p>
</div>
<p>You could define a classname to be loaded before loading the class with
the <code class="docutils literal notranslate"><span class="pre">Factories::define()</span></code> method:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">CodeIgniter\Config\Factories</span><span class="p">;</span>

<span class="nx">Factories</span><span class="o">::</span><span class="na">define</span><span class="p">(</span><span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="s1">&#39;Myth\Auth\Models\UserModel&#39;</span><span class="p">,</span> <span class="s1">&#39;App\Models\UserModel&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The first parameter is a component. The second parameter is a class alias
(the first parameter to Factories magic static method), and the third parameter
is the true fully qualified classname to be loaded.</p>
<p>After that, if you load <code class="docutils literal notranslate"><span class="pre">Myth\Auth\Models\UserModel</span></code> with Factories, the
<code class="docutils literal notranslate"><span class="pre">App\Models\UserModel</span></code> instance will be returned:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="nv">$users</span> <span class="o">=</span> <span class="nx">model</span><span class="p">(</span><span class="s1">&#39;Myth\Auth\Models\UserModel&#39;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="factory-parameters">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Factory Parameters</a><a class="headerlink" href="#factory-parameters" title="Permalink to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Factories</span></code> takes as a second parameter an array of option values (described below).
These directives will override the default options configured for each component.</p>
<p>Any more parameters passed at the same time will be forwarded on to the class
constructor, making it easy to configure your class instance on-the-fly. For example, say
your app uses a separate database for authentication and you want to be sure that any attempts
to access user records always go through that connection:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\Factories</span><span class="p">;</span>

<span class="nv">$conn</span>  <span class="o">=</span> <span class="nx">db_connect</span><span class="p">(</span><span class="s1">&#39;auth&#39;</span><span class="p">);</span>
<span class="nv">$users</span> <span class="o">=</span> <span class="nx">Factories</span><span class="o">::</span><span class="na">models</span><span class="p">(</span><span class="s1">&#39;UserModel&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="nv">$conn</span><span class="p">);</span>
</pre></div>
</div>
<p>Now any time the <code class="docutils literal notranslate"><span class="pre">UserModel</span></code> is loaded from <code class="docutils literal notranslate"><span class="pre">Factories</span></code> it will in fact be returning a
class instance that uses the alternate database connection.</p>
</section>
<section id="factories-options">
<span id="id1"></span><h2><a class="toc-backref" href="#id14" role="doc-backlink">Factories Options</a><a class="headerlink" href="#factories-options" title="Permalink to this heading"></a></h2>
<p>The default behavior might not work for every component. For example, say your component
name and its path do not align, or you need to limit instances to a certain type of class.
Each component takes a set of options to direct discovery and instantiation.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>component</p></td>
<td><p>string or null</p></td>
<td><p>The name of the component (if different than the static
method). This can be used to alias one component to another.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">null</span></code> (defaults to the component name)</p></td>
</tr>
<tr class="row-odd"><td><p>path</p></td>
<td><p>string or null</p></td>
<td><p>The relative path within the namespace/folder to look for
classes.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">null</span></code> (defaults to the component name,
but makes the first character uppercase)</p></td>
</tr>
<tr class="row-even"><td><p>instanceOf</p></td>
<td><p>string or null</p></td>
<td><p>A required class name to match on the returned instance.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">null</span></code> (no filtering)</p></td>
</tr>
<tr class="row-odd"><td><p>getShared</p></td>
<td><p>boolean</p></td>
<td><p>Whether to return a shared instance of the class or load a
fresh one.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
<tr class="row-even"><td><p>preferApp</p></td>
<td><p>boolean</p></td>
<td><p>Whether a class with the same basename in the App namespace
overrides other explicit class requests.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since v4.4.0, <code class="docutils literal notranslate"><span class="pre">preferApp</span></code> works only when you request
<a class="reference internal" href="#factories-passing-classname-without-namespace"><span class="std std-ref">a classname without a namespace</span></a>.</p>
</div>
</section>
<section id="factories-behavior">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Factories Behavior</a><a class="headerlink" href="#factories-behavior" title="Permalink to this heading"></a></h2>
<p>Options can be applied in one of three ways (listed in ascending priority):</p>
<ul class="simple">
<li><p>A configuration class <code class="docutils literal notranslate"><span class="pre">Config\Factory</span></code> with a property that matches the name of a component.</p></li>
<li><p>The static method <code class="docutils literal notranslate"><span class="pre">Factories::setOptions()</span></code>.</p></li>
<li><p>Passing options directly at call time with a parameter.</p></li>
</ul>
<section id="configurations">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Configurations</a><a class="headerlink" href="#configurations" title="Permalink to this heading"></a></h3>
<p>To set default component options, create a new Config files at <strong>app/Config/Factory.php</strong>
that supplies options as an array property that matches the name of the component.</p>
<section id="example-filters-factories">
<h4><a class="toc-backref" href="#id17" role="doc-backlink">Example: Filters Factories</a><a class="headerlink" href="#example-filters-factories" title="Permalink to this heading"></a></h4>
<p>For example, if you want to create <strong>Filters</strong> by Factories, the component name wll be <code class="docutils literal notranslate"><span class="pre">filters</span></code>.
And if you want to ensure that each filter is an instance of a class which implements CodeIgniter’s <code class="docutils literal notranslate"><span class="pre">FilterInterface</span></code>,
your <strong>app/Config/Factory.php</strong> file might look like this:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\Factory</span> <span class="k">as</span> <span class="nx">BaseFactory</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Filters\FilterInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Factory</span> <span class="k">extends</span> <span class="nx">BaseFactory</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$filters</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;instanceOf&#39;</span> <span class="o">=&gt;</span> <span class="nx">FilterInterface</span><span class="o">::</span><span class="na">class</span><span class="p">,</span>
    <span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now you can create a filter with code like <code class="docutils literal notranslate"><span class="pre">Factories::filters('SomeFilter')</span></code>,
and the returned instance will surely be a CodeIgniter’s filter.</p>
<p>This would prevent conflict of an third-party module which happened to have an
unrelated <code class="docutils literal notranslate"><span class="pre">Filters</span></code> path in its namespace.</p>
</section>
<section id="example-library-factories">
<h4><a class="toc-backref" href="#id18" role="doc-backlink">Example: Library Factories</a><a class="headerlink" href="#example-library-factories" title="Permalink to this heading"></a></h4>
<p>If you want to load your library classes in the <strong>app/Libraries</strong> directory with
<code class="docutils literal notranslate"><span class="pre">Factories::library('SomeLib')</span></code>, the path <cite>Libraries</cite> is different from the
default path <cite>Library</cite>.</p>
<p>In this case, your <strong>app/Config/Factory.php</strong> file will look like this:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\Factory</span> <span class="k">as</span> <span class="nx">BaseFactory</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Factory</span> <span class="k">extends</span> <span class="nx">BaseFactory</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$library</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Libraries&#39;</span><span class="p">,</span>
    <span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now you can load your libraries with the <code class="docutils literal notranslate"><span class="pre">Factories::library()</span></code> method:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">CodeIgniter\Config\Factories</span><span class="p">;</span>

<span class="nv">$someLib</span> <span class="o">=</span> <span class="nx">Factories</span><span class="o">::</span><span class="na">library</span><span class="p">(</span><span class="s1">&#39;SomeLib&#39;</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="setoptions-method">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">setOptions Method</a><a class="headerlink" href="#setoptions-method" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Factories</span></code> class has a static method to allow runtime option configuration: simply
supply the desired array of options using the <code class="docutils literal notranslate"><span class="pre">setOptions()</span></code> method and they will be
merged with the default values and stored for the next call:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\Factories</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Filters\FilterInterface</span><span class="p">;</span>

<span class="nx">Factories</span><span class="o">::</span><span class="na">setOptions</span><span class="p">(</span><span class="s1">&#39;filters&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;instanceOf&#39;</span> <span class="o">=&gt;</span> <span class="nx">FilterInterface</span><span class="o">::</span><span class="na">class</span><span class="p">,</span>
    <span class="s1">&#39;prefersApp&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
<span class="p">]);</span>
</pre></div>
</div>
</section>
<section id="parameter-options">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Parameter Options</a><a class="headerlink" href="#parameter-options" title="Permalink to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Factories</span></code>’s magic static call takes as a second parameter an array of option values.
These directives will override the stored options configured for each component and can be
used at call time to get exactly what you need. The input should be an array with option
names as keys to each overriding value.</p>
<p>For example, by default <code class="docutils literal notranslate"><span class="pre">Factories</span></code> assumes that you want to locate a shared instance of
a component. By adding a second parameter to the magic static call, you can control whether
that single call will return a new or shared instance:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">CodeIgniter\Config\Factories</span><span class="p">;</span>

<span class="nv">$users</span> <span class="o">=</span> <span class="nx">Factories</span><span class="o">::</span><span class="na">models</span><span class="p">(</span><span class="s1">&#39;UserModel&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;getShared&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">]);</span>  <span class="c1">// Default; will always be the same instance</span>
<span class="nv">$other</span> <span class="o">=</span> <span class="nx">Factories</span><span class="o">::</span><span class="na">models</span><span class="p">(</span><span class="s1">&#39;UserModel&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;getShared&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">]);</span> <span class="c1">// Will always create a new instance</span>
</pre></div>
</div>
</section>
</section>
<section id="config-caching">
<span id="factories-config-caching"></span><h2><a class="toc-backref" href="#id21" role="doc-backlink">Config Caching</a><a class="headerlink" href="#config-caching" title="Permalink to this heading"></a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 4.4.0.</span></p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Do not use this feature unless you have carefully read this section
and understand how this feature works. Otherwise, your application will not
function properly.</p>
</div>
<p>To improve performance, Config Caching has been implemented.</p>
<section id="prerequisite">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Prerequisite</a><a class="headerlink" href="#prerequisite" title="Permalink to this heading"></a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Using this feature when the prerequisites are not met will prevent
CodeIgniter from operating properly. Do not use this feature in such cases.</p>
</div>
<ul class="simple">
<li><p>To use this feature, the properties of all Config objects instantiated in
Factories must not be modified after instantiation. Put another way, the Config
classes must be an immutable or readonly classes.</p></li>
<li><p>By default, every Config class that is cached must implement <code class="docutils literal notranslate"><span class="pre">__set_state()</span></code>
method.</p></li>
</ul>
</section>
<section id="how-it-works">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">How It Works</a><a class="headerlink" href="#how-it-works" title="Permalink to this heading"></a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Once cached, configuration values are never changed until the cache
is deleted, even if the configuration file or <strong>.env</strong> is changed.</p>
</div>
<ul class="simple">
<li><p>Save the all Config instances in Factories into a cache file before shutdown,
if the state of the Config instances in Factories changes.</p></li>
<li><p>Restore cached Config instances before CodeIgniter initialization if a cache
is available.</p></li>
</ul>
<p>Simply put, all Config instances held by Factories are cached immediately prior
to shutdown, and the cached instances are used permanently.</p>
</section>
<section id="how-to-update-config-values">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">How to Update Config Values</a><a class="headerlink" href="#how-to-update-config-values" title="Permalink to this heading"></a></h3>
<p>Once stored, the cached versions never expire. Changing a existing Config file
(or changing Environment Variables for it) will not update the cache nor the Config
values.</p>
<p>So if you want to update Config values, update Config files or Environment Variables
for them, and you must manually delete the cache file.</p>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">spark</span> <span class="pre">cache:clear</span></code> command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">php spark cache:clear</span>
</pre></div>
</div>
<p>Or simply delete the <strong>writable/cache/FactoriesCache_config</strong> file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since v4.5.0, the <code class="docutils literal notranslate"><span class="pre">spark</span> <span class="pre">optimize</span></code> command clears the cache.</p>
</div>
</section>
<section id="how-to-enable-config-caching">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">How to Enable Config Caching</a><a class="headerlink" href="#how-to-enable-config-caching" title="Permalink to this heading"></a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 4.5.0.</span></p>
</div>
<p>Set the following property to <code class="docutils literal notranslate"><span class="pre">true</span></code> in <strong>app/Config/Optimize.php</strong>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="nx">bool</span> <span class="nv">$configCacheEnabled</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</pre></div>
</div>
<p>Or you can enable this with the <code class="docutils literal notranslate"><span class="pre">spark</span> <span class="pre">optimize</span></code> command.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This property cannot be overridden by
<a class="reference internal" href="../general/configuration.html#configuration-classes-and-environment-variables"><span class="std std-ref">environment variables</span></a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In v4.4.x, uncomment the following code in <strong>public/index.php</strong>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">---</span> <span class="nx">a</span><span class="o">/</span><span class="k">public</span><span class="o">/</span><span class="nx">index</span><span class="o">.</span><span class="nx">php</span>
<span class="o">+++</span> <span class="nx">b</span><span class="o">/</span><span class="k">public</span><span class="o">/</span><span class="nx">index</span><span class="o">.</span><span class="nx">php</span>
<span class="o">@@</span> <span class="o">-</span><span class="mi">49</span><span class="p">,</span><span class="mi">8</span> <span class="o">+</span><span class="mi">49</span><span class="p">,</span><span class="mi">8</span> <span class="o">@@</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nb">defined</span><span class="p">(</span><span class="s1">&#39;ENVIRONMENT&#39;</span><span class="p">))</span> <span class="p">{</span>
 <span class="p">}</span>

 <span class="c1">// Load Config Cache</span>
<span class="o">-//</span> <span class="nv">$factoriesCache</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\CodeIgniter\Cache\FactoriesCache</span><span class="p">();</span>
<span class="o">-//</span> <span class="nv">$factoriesCache</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="nv">$factoriesCache</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\CodeIgniter\Cache\FactoriesCache</span><span class="p">();</span>
<span class="o">+</span><span class="nv">$factoriesCache</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">);</span>
 <span class="c1">// ^^^ Uncomment these lines if you want to use Config Caching.</span>

 <span class="o">/*</span>
<span class="o">@@</span> <span class="o">-</span><span class="mi">79</span><span class="p">,</span><span class="mi">7</span> <span class="o">+</span><span class="mi">79</span><span class="p">,</span><span class="mi">7</span> <span class="o">@@</span> <span class="nv">$app</span><span class="o">-&gt;</span><span class="na">setContext</span><span class="p">(</span><span class="nv">$context</span><span class="p">);</span>
 <span class="nv">$app</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span>

 <span class="c1">// Save Config Cache</span>
<span class="o">-//</span> <span class="nv">$factoriesCache</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="nv">$factoriesCache</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">);</span>
 <span class="c1">// ^^^ Uncomment this line if you want to use Config Caching.</span>

 <span class="c1">// Exits the application, setting the exit code for CLI-based applications</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="services.html" class="btn btn-neutral float-left" title="Services" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="http.html" class="btn btn-neutral float-right" title="Working with HTTP Requests" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2025 CodeIgniter Foundation.
      <span class="lastupdated">Last updated on Jan 23, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>