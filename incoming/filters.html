<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Controller Filters &mdash; CodeIgniter 4.6.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/citheme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/citheme_dark.css" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/js/citheme.js"></script>
        <script src="../_static/js/carbon.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Auto Routing (Improved)" href="auto_routing_improved.html" />
    <link rel="prev" title="Controllers" href="controllers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/ci-logo-text.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Welcome to CodeIgniter4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/index.html">Welcome to CodeIgniter4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/requirements.html">Server Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/credits.html">Credits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/psr.html">PSR Compliance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../license.html">License Agreement</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_composer.html">Composer Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_manual.html">Manual Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/running.html">Running Your App</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/deployment.html">Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelogs/index.html">Change Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/upgrading.html">Upgrading From a Previous Version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/repositories.html">CodeIgniter Repositories</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Build Your First Application</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/static_pages.html">Static Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/news_section.html">News Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/create_news_items.html">Create News Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/conclusion.html">Conclusion</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/index.html">CodeIgniter4 Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../concepts/structure.html">Application Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/mvc.html">Models, Views, and Controllers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/autoloader.html">Autoloading Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/services.html">Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/factories.html">Factories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/http.html">Working with HTTP Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/security.html">Security Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/goals.html">Design and Architectural Goals</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/index.html">General Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../general/configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/urls.html">CodeIgniter URLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/helpers.html">Helper Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/common_functions.html">Global Functions and Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/logging.html">Logging Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/errors.html">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/caching.html">Web Page Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/ajax.html">AJAX Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/modules.html">Code Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/managing_apps.html">Managing your Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/environments.html">Handling Multiple Environments</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Controllers and Routing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="routing.html">URI Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="controllers.html">Controllers</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Controller Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_routing_improved.html">Auto Routing (Improved)</a></li>
<li class="toctree-l2"><a class="reference internal" href="message.html">HTTP Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="request.html">Request Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="incomingrequest.html">IncomingRequest Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="content_negotiation.html">Content Negotiation</a></li>
<li class="toctree-l2"><a class="reference internal" href="methodspoofing.html">HTTP Method Spoofing</a></li>
<li class="toctree-l2"><a class="reference internal" href="restful.html">RESTful Resource Handling</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../outgoing/index.html">Building Responses</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/views.html">Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_renderer.html">View Renderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_layouts.html">View Layouts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_cells.html">View Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_parser.html">View Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_decorators.html">View Decorators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/table.html">HTML Table Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/response.html">HTTP Responses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/api_responses.html">API Response Trait</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/csp.html">Content Security Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/localization.html">Localization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/alternative_php.html">Alternate PHP Syntax for View Files</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../database/index.html">Working with Databases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../database/examples.html">Quick Start: Usage Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/configuration.html">Database Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/connecting.html">Connecting to a Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/queries.html">Running Queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/results.html">Generating Query Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/helpers.html">Query Helper Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/query_builder.html">Query Builder Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/transactions.html">Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/metadata.html">Getting Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/call_function.html">Custom Function Calls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/events.html">Database Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/utilities.html">Database Utilities</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">Modeling Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/model.html">Using CodeIgniter's Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/entities.html">Using Entity Classes</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dbmgmt/index.html">Managing Databases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/forge.html">Database Forge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/migration.html">Database Migrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/seeds.html">Database Seeding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/db_commands.html">Database Commands</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../libraries/index.html">Library Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../libraries/caching.html">Caching Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/cookies.html">Cookies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/cors.html">Cross-Origin Resource Sharing (CORS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/curlrequest.html">CURLRequest Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/email.html">Email Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/encryption.html">Encryption Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/files.html">Working with Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/file_collections.html">File Collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/honeypot.html">Honeypot Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/images.html">Image Manipulation Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/pagination.html">Pagination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/publisher.html">Publisher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/security.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/sessions.html">Session Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/throttler.html">Throttler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/time.html">Times and Dates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/typography.html">Typography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/uploaded_files.html">Working with Uploaded Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/uri.html">Working with URIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/user_agent.html">User Agent Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/validation.html">Validation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../helpers/index.html">Helpers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../helpers/array_helper.html">Array Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/cookie_helper.html">Cookie Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/date_helper.html">Date Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/filesystem_helper.html">Filesystem Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/form_helper.html">Form Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/html_helper.html">HTML Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/inflector_helper.html">Inflector Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/number_helper.html">Number Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/security_helper.html">Security Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/test_helper.html">Test Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/text_helper.html">Text Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/url_helper.html">URL Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/xml_helper.html">XML Helper</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing/overview.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/database.html">Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/fabricator.html">Generating Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/controllers.html">Controller Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/feature.html">HTTP Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/response.html">Testing Responses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/cli.html">Testing CLI Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/mocking.html">Mocking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/benchmark.html">Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/debugging.html">Debugging Your Application</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">Command Line Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_overview.html">CLI Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_controllers.html">Running Controllers via CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/spark_commands.html">Spark Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_commands.html">Creating Spark Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_generators.html">CLI Generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_library.html">CLI Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_request.html">CLIRequest Class</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extending/index.html">Extending CodeIgniter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extending/core_classes.html">Creating Core System Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/common.html">Replacing Common Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/events.html">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/basecontroller.html">Extending the Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/authentication.html">Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/composer_packages.html">Creating Composer Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/contributing.html">Contributing to CodeIgniter</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../libraries/official_packages.html">Official Packages</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CodeIgniter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
<a class="btn btn-neutral float-right" href="https://github.com/codeigniter4/CodeIgniter4/edit/develop/user_guide_src/source/incoming/filters.rst">Edit this page</a>

          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Controllers and Routing</a></li>
      <li class="breadcrumb-item active">Controller Filters</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="controller-filters">
<h1>Controller Filters<a class="headerlink" href="#controller-filters" title="Permalink to this heading"></a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#creating-a-filter" id="id8">Creating a Filter</a></p>
<ul>
<li><p><a class="reference internal" href="#before-filters" id="id9">Before Filters</a></p>
<ul>
<li><p><a class="reference internal" href="#replacing-request" id="id10">Replacing Request</a></p></li>
<li><p><a class="reference internal" href="#stopping-later-filters" id="id11">Stopping Later Filters</a></p></li>
<li><p><a class="reference internal" href="#returning-response" id="id12">Returning Response</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#after-filters" id="id13">After Filters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configuring-filters" id="id14">Configuring Filters</a></p>
<ul>
<li><p><a class="reference internal" href="#app-config-filters-php" id="id15">app/Config/Filters.php</a></p>
<ul>
<li><p><a class="reference internal" href="#aliases" id="id16">$aliases</a></p></li>
<li><p><a class="reference internal" href="#required" id="id17">$required</a></p></li>
<li><p><a class="reference internal" href="#globals" id="id18">$globals</a></p></li>
<li><p><a class="reference internal" href="#methods" id="id19">$methods</a></p></li>
<li><p><a class="reference internal" href="#filters" id="id20">$filters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#filter-execution-order" id="id21">Filter Execution Order</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#confirming-filters" id="id22">Confirming Filters</a></p>
<ul>
<li><p><a class="reference internal" href="#filter-check" id="id23">filter:check</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#provided-filters" id="id24">Provided Filters</a></p>
<ul>
<li><p><a class="reference internal" href="#forcehttps" id="id25">ForceHTTPS</a></p></li>
<li><p><a class="reference internal" href="#performancemetrics" id="id26">PerformanceMetrics</a></p></li>
<li><p><a class="reference internal" href="#invalidchars" id="id27">InvalidChars</a></p></li>
<li><p><a class="reference internal" href="#secureheaders" id="id28">SecureHeaders</a></p></li>
</ul>
</li>
</ul>
</nav>
<p>Controller Filters allow you to perform actions either before or after the controllers execute. Unlike <a class="reference internal" href="../extending/events.html"><span class="doc">events</span></a>,
you can choose the specific URIs or routes in which the filters will be applied to. Before filters may
modify the Request while after filters can act on and even modify the Response, allowing for a lot of flexibility
and power.</p>
<p>Some common examples of tasks that might be performed with filters are:</p>
<ul class="simple">
<li><p>Performing CSRF protection on the incoming requests</p></li>
<li><p>Restricting areas of your site based upon their Role</p></li>
<li><p>Perform rate limiting on certain endpoints</p></li>
<li><p>Display a “Down for Maintenance” page</p></li>
<li><p>Perform automatic content negotiation</p></li>
<li><p>and more…</p></li>
</ul>
<section id="creating-a-filter">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Creating a Filter</a><a class="headerlink" href="#creating-a-filter" title="Permalink to this heading"></a></h2>
<p>Filters are simple classes that implement <code class="docutils literal notranslate"><span class="pre">CodeIgniter\Filters\FilterInterface</span></code>.
They contain two methods: <code class="docutils literal notranslate"><span class="pre">before()</span></code> and <code class="docutils literal notranslate"><span class="pre">after()</span></code> which hold the code that
will run before and after the controller respectively. Your class must contain both methods
but may leave the methods empty if they are not needed. A skeleton filter class looks like:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Filters</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Filters\FilterInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">CodeIgniter\HTTP\RequestInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">CodeIgniter\HTTP\ResponseInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyFilter</span> <span class="k">implements</span> <span class="nx">FilterInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">before</span><span class="p">(</span><span class="nx">RequestInterface</span> <span class="nv">$request</span><span class="p">,</span> <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Do something here</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">after</span><span class="p">(</span><span class="nx">RequestInterface</span> <span class="nv">$request</span><span class="p">,</span> <span class="nx">ResponseInterface</span> <span class="nv">$response</span><span class="p">,</span> <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Do something here</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="before-filters">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Before Filters</a><a class="headerlink" href="#before-filters" title="Permalink to this heading"></a></h3>
<section id="replacing-request">
<h4><a class="toc-backref" href="#id10" role="doc-backlink">Replacing Request</a><a class="headerlink" href="#replacing-request" title="Permalink to this heading"></a></h4>
<p>From any filter, you can return the <code class="docutils literal notranslate"><span class="pre">$request</span></code> object and it will replace the current Request, allowing you
to make changes that will still be present when the controller executes.</p>
</section>
<section id="stopping-later-filters">
<h4><a class="toc-backref" href="#id11" role="doc-backlink">Stopping Later Filters</a><a class="headerlink" href="#stopping-later-filters" title="Permalink to this heading"></a></h4>
<p>Also, when you have a series of filters you may also want to
stop the execution of the later filters after a certain filter. You can easily do this by returning
<strong>any non-empty</strong> result. If the before filter returns an empty result, the controller actions or the later
filters will still be executed.</p>
<p>An exception to the non-empty result rule is the <code class="docutils literal notranslate"><span class="pre">Request</span></code> instance.
Returning it in the before filter will not stop the execution but only replace the current <code class="docutils literal notranslate"><span class="pre">$request</span></code> object.</p>
</section>
<section id="returning-response">
<h4><a class="toc-backref" href="#id12" role="doc-backlink">Returning Response</a><a class="headerlink" href="#returning-response" title="Permalink to this heading"></a></h4>
<p>Since before filters are executed prior to your controller being executed, you may at times want to stop the
actions in the controller from happening.</p>
<p>This is typically used to perform redirects, like in this example:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Filters</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Filters\FilterInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">CodeIgniter\HTTP\RequestInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">CodeIgniter\HTTP\ResponseInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyFilter</span> <span class="k">implements</span> <span class="nx">FilterInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">before</span><span class="p">(</span><span class="nx">RequestInterface</span> <span class="nv">$request</span><span class="p">,</span> <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$auth</span> <span class="o">=</span> <span class="nx">service</span><span class="p">(</span><span class="s1">&#39;auth&#39;</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nv">$auth</span><span class="o">-&gt;</span><span class="na">isLoggedIn</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">redirect</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">to</span><span class="p">(</span><span class="nx">site_url</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If a <code class="docutils literal notranslate"><span class="pre">Response</span></code> instance is returned, the Response will be sent back to the client and script execution will stop.
This can be useful for implementing rate limiting for APIs. See <a class="reference internal" href="../libraries/throttler.html"><span class="doc">Throttler</span></a> for an
example.</p>
</section>
</section>
<section id="after-filters">
<span id="id1"></span><h3><a class="toc-backref" href="#id13" role="doc-backlink">After Filters</a><a class="headerlink" href="#after-filters" title="Permalink to this heading"></a></h3>
<p>After filters are nearly identical to before filters, except that you can only return the <code class="docutils literal notranslate"><span class="pre">$response</span></code> object,
and you cannot stop script execution. This does allow you to modify the final output, or simply do something with
the final output. This could be used to ensure certain security headers were set the correct way, or to cache
the final output, or even to filter the final output with a bad words filter.</p>
</section>
</section>
<section id="configuring-filters">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Configuring Filters</a><a class="headerlink" href="#configuring-filters" title="Permalink to this heading"></a></h2>
<p>There are two ways to configure filters when they get run. One is done in
<strong>app/Config/Filters.php</strong>, the other is done in <strong>app/Config/Routes.php</strong>.</p>
<p>If you want to specify filters to defined routes, use <strong>app/Config/Routes.php</strong>
and see <a class="reference internal" href="routing.html#applying-filters"><span class="std std-ref">URI Routing</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The safest way to apply filters is to <a class="reference internal" href="routing.html#use-defined-routes-only"><span class="std std-ref">disable auto-routing</span></a>, and <a class="reference internal" href="routing.html#applying-filters"><span class="std std-ref">set filters to routes</span></a>.</p>
</div>
<section id="app-config-filters-php">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">app/Config/Filters.php</a><a class="headerlink" href="#app-config-filters-php" title="Permalink to this heading"></a></h3>
<p>The <strong>app/Config/Filters.php</strong> file contains four properties that allow you to
configure exactly when the filters run.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is recommended that you should always add <code class="docutils literal notranslate"><span class="pre">*</span></code> at the end of a URI in the filter settings.
Because a controller method might be accessible by different URLs than you think.
For example, when <a class="reference internal" href="routing.html#auto-routing-legacy"><span class="std std-ref">Auto Routing (Legacy)</span></a> is enabled, if you have <code class="docutils literal notranslate"><span class="pre">Blog::index()</span></code>,
it can be accessible with <code class="docutils literal notranslate"><span class="pre">blog</span></code>, <code class="docutils literal notranslate"><span class="pre">blog/index</span></code>, and <code class="docutils literal notranslate"><span class="pre">blog/index/1</span></code>, etc.</p>
</div>
<section id="aliases">
<span id="filters-aliases"></span><h4><a class="toc-backref" href="#id16" role="doc-backlink">$aliases</a><a class="headerlink" href="#aliases" title="Permalink to this heading"></a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">$aliases</span></code> array is used to associate a simple name with one or more fully-qualified class names that are the
filters to run:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">array</span> <span class="nv">$aliases</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;csrf&#39;</span> <span class="o">=&gt;</span> <span class="nx">\CodeIgniter\Filters\CSRF</span><span class="o">::</span><span class="na">class</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Aliases are mandatory and if you try to use a full class name later, the system will throw an error.</p>
<p>Defining them
in this way makes it simple to switch out the class used. Great for when you decided you need to change to a
different authentication system since you only change the filter’s class and you’re done.</p>
<p>You can combine multiple filters into one alias, making complex sets of filters simple to apply:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">array</span> <span class="nv">$aliases</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;api-prep&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="nx">\App\Filters\Negotiate</span><span class="o">::</span><span class="na">class</span><span class="p">,</span>
            <span class="nx">\App\Filters\ApiAuth</span><span class="o">::</span><span class="na">class</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You should define as many aliases as you need.</p>
</section>
<section id="required">
<span id="filters-required"></span><h4><a class="toc-backref" href="#id17" role="doc-backlink">$required</a><a class="headerlink" href="#required" title="Permalink to this heading"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">New in version 4.5.0.</span></p>
</div>
<p>The second section allows you to define <strong>Required Filters</strong>.
They are special filters that are applied to every request made by the
framework. They are applied before and after other kinds of filters that are
explained below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Required Filters are always executed. However, if the route does not exist, only the Before Filters are executed.</p>
</div>
<p>You should take care with how many you use here, since it could have performance
implications to have too many run on every request. But the filters set by default
provide framework functionality. If removed, those functions will no longer work.
See <a class="reference internal" href="#provided-filters"><span class="std std-ref">Provided Filters</span></a> for details.</p>
<p>Filters can be specified by adding their alias to either the <code class="docutils literal notranslate"><span class="pre">before</span></code> or <code class="docutils literal notranslate"><span class="pre">after</span></code> array:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">array</span> <span class="nv">$required</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;before&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;forcehttps&#39;</span><span class="p">,</span> <span class="c1">// Force Global Secure Requests</span>
            <span class="s1">&#39;pagecache&#39;</span><span class="p">,</span>  <span class="c1">// Web Page Caching</span>
        <span class="p">],</span>
        <span class="s1">&#39;after&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;pagecache&#39;</span><span class="p">,</span>   <span class="c1">// Web Page Caching</span>
            <span class="s1">&#39;performance&#39;</span><span class="p">,</span> <span class="c1">// Performance Metrics</span>
            <span class="s1">&#39;toolbar&#39;</span><span class="p">,</span>     <span class="c1">// Debug Toolbar</span>
        <span class="p">],</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="globals">
<span id="filters-globals"></span><h4><a class="toc-backref" href="#id18" role="doc-backlink">$globals</a><a class="headerlink" href="#globals" title="Permalink to this heading"></a></h4>
<p>The third section allows you to define any filters that should be applied to every valid request made by the framework.</p>
<p>You should take care with how many you use here, since it could have performance implications to have too many
run on every request.</p>
<p>Filters can be specified by adding their alias to either the <code class="docutils literal notranslate"><span class="pre">before</span></code> or <code class="docutils literal notranslate"><span class="pre">after</span></code> array:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="k">public</span> <span class="k">array</span> <span class="nv">$globals</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;before&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;csrf&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;after&#39;</span> <span class="o">=&gt;</span> <span class="p">[],</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="except-for-a-few-uris">
<h5>Except for a Few URIs<a class="headerlink" href="#except-for-a-few-uris" title="Permalink to this heading"></a></h5>
<p>There are times where you want to apply a filter to almost every request, but have a few that should be left alone.
One common example is if you need to exclude a few URI’s from the CSRF protection filter to allow requests from
third-party websites to hit one or two specific URI’s, while keeping the rest of them protected.</p>
<p>To do this, add
an array with the <code class="docutils literal notranslate"><span class="pre">except</span></code> key and a URI path (relative to BaseURL) to match as the value alongside the alias:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="k">public</span> <span class="k">array</span> <span class="nv">$globals</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;before&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;csrf&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;except&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;api/*&#39;</span><span class="p">],</span>
        <span class="p">],</span>
        <span class="s1">&#39;after&#39;</span> <span class="o">=&gt;</span> <span class="p">[],</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Prior to v4.4.7, due to a bug, the URI paths processed by the filter
were not URL-decoded. In other words, the URI paths specified in the routing
and the URI paths specified in the filter could be different.
See <a class="reference internal" href="../installation/upgrade_447.html#upgrade-447-filter-paths"><span class="std std-ref">Paths in Controller Filters</span></a> for details.</p>
</div>
<p>Any place you can use a URI path (relative to BaseURL) in the filter settings, you can use a regular expression or, like in this example above, use
an asterisk (<code class="docutils literal notranslate"><span class="pre">*</span></code>) for a wildcard that will match all characters after that. In this example, any URI path starting with <code class="docutils literal notranslate"><span class="pre">api/</span></code>
would be exempted from CSRF protection, but the site’s forms would all be protected.</p>
<p>If you need to specify multiple
URI paths, you can use an array of URI path patterns:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="k">public</span> <span class="k">array</span> <span class="nv">$globals</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;before&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;csrf&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;except&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;foo/*&#39;</span><span class="p">,</span> <span class="s1">&#39;bar/*&#39;</span><span class="p">]],</span>
        <span class="p">],</span>
        <span class="s1">&#39;after&#39;</span> <span class="o">=&gt;</span> <span class="p">[],</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="methods">
<h4><a class="toc-backref" href="#id19" role="doc-backlink">$methods</a><a class="headerlink" href="#methods" title="Permalink to this heading"></a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you use <code class="docutils literal notranslate"><span class="pre">$methods</span></code> filters, you should <a class="reference internal" href="routing.html#use-defined-routes-only"><span class="std std-ref">disable Auto Routing (Legacy)</span></a>
because <a class="reference internal" href="routing.html#auto-routing-legacy"><span class="std std-ref">Auto Routing (Legacy)</span></a> permits any HTTP method to access a controller.
Accessing the controller with a method you don’t expect could bypass the filter.</p>
</div>
<p>You can apply filters to all requests of a certain HTTP method, like <code class="docutils literal notranslate"><span class="pre">POST</span></code>, <code class="docutils literal notranslate"><span class="pre">GET</span></code>, <code class="docutils literal notranslate"><span class="pre">PUT</span></code>, etc.
It’s value would be an array of filters to run:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="k">public</span> <span class="k">array</span> <span class="nv">$methods</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;POST&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;invalidchars&#39;</span><span class="p">,</span> <span class="s1">&#39;csrf&#39;</span><span class="p">],</span>
        <span class="s1">&#39;GET&#39;</span>  <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;csrf&#39;</span><span class="p">],</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike the <code class="docutils literal notranslate"><span class="pre">$globals</span></code> or the
<code class="docutils literal notranslate"><span class="pre">$filters</span></code> properties, these will only run as before filters.</p>
</div>
<p>In addition to the standard HTTP methods, this also supports one special case: <code class="docutils literal notranslate"><span class="pre">CLI</span></code>. The <code class="docutils literal notranslate"><span class="pre">CLI</span></code> method would apply to
all requests that were run from the command line.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Prior to v4.5.0, due to a bug, you needed to specify the HTTP method names in <strong>lowercase</strong>.</p>
</div>
</section>
<section id="filters">
<h4><a class="toc-backref" href="#id20" role="doc-backlink">$filters</a><a class="headerlink" href="#filters" title="Permalink to this heading"></a></h4>
<p>This property is an array of filter aliases. For each alias, you can specify <code class="docutils literal notranslate"><span class="pre">before</span></code> and <code class="docutils literal notranslate"><span class="pre">after</span></code> arrays that contain
a list of URI path (relative to BaseURL) patterns that filter should apply to:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="k">public</span> <span class="k">array</span> <span class="nv">$filters</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;foo&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;before&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;admin/*&#39;</span><span class="p">],</span> <span class="s1">&#39;after&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;users/*&#39;</span><span class="p">]],</span>
        <span class="s1">&#39;bar&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;before&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;api/*&#39;</span><span class="p">,</span> <span class="s1">&#39;admin/*&#39;</span><span class="p">]],</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Prior to v4.4.7, due to a bug, the URI paths processed by the filter
were not URL-decoded. In other words, the URI paths specified in the routing
and the URI paths specified in the filter could be different.
See <a class="reference internal" href="../installation/upgrade_447.html#upgrade-447-filter-paths"><span class="std std-ref">Paths in Controller Filters</span></a> for details.</p>
</div>
<section id="filter-arguments">
<span id="filters-filters-filter-arguments"></span><h5>Filter Arguments<a class="headerlink" href="#filter-arguments" title="Permalink to this heading"></a></h5>
<div class="versionadded">
<p><span class="versionmodified added">New in version 4.4.0.</span></p>
</div>
<p>When configuring <code class="docutils literal notranslate"><span class="pre">$filters</span></code>, additional arguments may be passed to a filter:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="k">public</span> <span class="nv">$filters</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;group:admin,superadmin&#39;</span>  <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;before&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;admin/*&#39;</span><span class="p">]],</span>
        <span class="s1">&#39;permission:users.manage&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;before&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;admin/users/*&#39;</span><span class="p">]],</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this example, when the URI matches <code class="docutils literal notranslate"><span class="pre">admin/*'</span></code>, the array <code class="docutils literal notranslate"><span class="pre">['admin',</span> <span class="pre">'superadmin']</span></code>
will be passed in <code class="docutils literal notranslate"><span class="pre">$arguments</span></code> to the <code class="docutils literal notranslate"><span class="pre">group</span></code> filter’s <code class="docutils literal notranslate"><span class="pre">before()</span></code> methods.
When the URI matches <code class="docutils literal notranslate"><span class="pre">admin/users/*'</span></code>, the array <code class="docutils literal notranslate"><span class="pre">['users.manage']</span></code>
will be passed in <code class="docutils literal notranslate"><span class="pre">$arguments</span></code> to the <code class="docutils literal notranslate"><span class="pre">permission</span></code> filter’s <code class="docutils literal notranslate"><span class="pre">before()</span></code> methods.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Prior to v4.6.0, the same filter cannot be run multiple times with
different arguments.</p>
</div>
</section>
</section>
</section>
<section id="filter-execution-order">
<span id="id2"></span><h3><a class="toc-backref" href="#id21" role="doc-backlink">Filter Execution Order</a><a class="headerlink" href="#filter-execution-order" title="Permalink to this heading"></a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Starting with v4.5.0, the order in which filters are executed has
changed. If you wish to maintain the same execution order as in previous versions,
you must set <code class="docutils literal notranslate"><span class="pre">true</span></code> to <code class="docutils literal notranslate"><span class="pre">Config\Feature::$oldFilterOrder</span></code>.</p>
</div>
<p>Filters are executed in the following order:</p>
<ul class="simple">
<li><p><strong>Before Filters</strong>: required → globals → methods → filters → route</p></li>
<li><p><strong>After Filters</strong>: route → filters → globals → required</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <em>required</em> filters can be used since v4.5.0.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Prior to v4.5.0, the filters that are specified to a route
(in <strong>app/Config/Routes.php</strong>) are executed before the filters specified in
<strong>app/Config/Filters.php</strong>. And the After Filters in Route filters and Filters
filters execution order were not reversed.
See <a class="reference internal" href="../installation/upgrade_450.html#upgrade-450-filter-execution-order"><span class="std std-ref">Upgrading Guide</span></a> for details.</p>
</div>
</section>
</section>
<section id="confirming-filters">
<h2><a class="toc-backref" href="#id22" role="doc-backlink">Confirming Filters</a><a class="headerlink" href="#confirming-filters" title="Permalink to this heading"></a></h2>
<p>CodeIgniter has the following <a class="reference internal" href="../cli/spark_commands.html"><span class="doc">command</span></a> to check the filters for a route.</p>
<section id="filter-check">
<span id="spark-filter-check"></span><h3><a class="toc-backref" href="#id23" role="doc-backlink">filter:check</a><a class="headerlink" href="#filter-check" title="Permalink to this heading"></a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 4.3.0.</span></p>
</div>
<p>For example, check the filters for the route <code class="docutils literal notranslate"><span class="pre">/</span></code> with <strong>GET</strong> method:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">php spark filter:check get /</span>
</pre></div>
</div>
<p>The output is like the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+--------+-------+----------------------+-------------------------------+
| Method | Route | Before Filters       | After Filters                 |
+--------+-------+----------------------+-------------------------------+
| GET    | /     | forcehttps pagecache | pagecache performance toolbar |
+--------+-------+----------------------+-------------------------------+

Before Filter Classes:
CodeIgniter\Filters\ForceHTTPS → CodeIgniter\Filters\PageCache
After Filter Classes:
CodeIgniter\Filters\PageCache → CodeIgniter\Filters\PerformanceMetrics → CodeIgniter\Filters\DebugToolbar
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since v4.6.0, filter arguments have been displayed in the output table.
Also, the actual filter classnames have been displayed in the end.</p>
</div>
<p>You can also see the routes and filters by the <code class="docutils literal notranslate"><span class="pre">spark</span> <span class="pre">routes</span></code> command,
but it might not show accurate filters when you use regular expressions for routes.
See <a class="reference internal" href="routing.html#routing-spark-routes"><span class="std std-ref">URI Routing</span></a> for details.</p>
</section>
</section>
<section id="provided-filters">
<span id="id3"></span><h2><a class="toc-backref" href="#id24" role="doc-backlink">Provided Filters</a><a class="headerlink" href="#provided-filters" title="Permalink to this heading"></a></h2>
<p>The filters bundled with CodeIgniter4 are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cors</span></code> =&gt; <a class="reference internal" href="../libraries/cors.html"><span class="doc">Cross-Origin Resource Sharing (CORS)</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">csrf</span></code> =&gt; <a class="reference internal" href="../libraries/security.html#cross-site-request-forgery"><span class="std std-ref">CSRF</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">toolbar</span></code> =&gt; <a class="reference internal" href="../testing/debugging.html#the-debug-toolbar"><span class="std std-ref">DebugToolbar</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">honeypot</span></code> =&gt; <a class="reference internal" href="../libraries/honeypot.html"><span class="doc">Honeypot</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">invalidchars</span></code> =&gt; <a class="reference internal" href="#invalidchars"><span class="std std-ref">InvalidChars</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secureheaders</span></code> =&gt; <a class="reference internal" href="#secureheaders"><span class="std std-ref">SecureHeaders</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forcehttps</span></code> =&gt; <a class="reference internal" href="#forcehttps"><span class="std std-ref">ForceHTTPS</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pagecache</span></code> =&gt; <a class="reference internal" href="../general/caching.html"><span class="doc">PageCache</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">performance</span></code> =&gt; <a class="reference internal" href="#performancemetrics"><span class="std std-ref">PerformanceMetrics</span></a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The filters are executed in the order defined in the config file. However, if enabled, <code class="docutils literal notranslate"><span class="pre">DebugToolbar</span></code> is always executed last because it should be able to capture everything that happens in the other filters.</p>
</div>
<section id="forcehttps">
<span id="id4"></span><h3><a class="toc-backref" href="#id25" role="doc-backlink">ForceHTTPS</a><a class="headerlink" href="#forcehttps" title="Permalink to this heading"></a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 4.5.0.</span></p>
</div>
<p>This filter provides the “Force Global Secure Requests” feature.</p>
<p>If you set <code class="docutils literal notranslate"><span class="pre">Config\App:$forceGlobalSecureRequests</span></code> to true, this will force
every request made to this application to be made via a secure connection (HTTPS).
If the incoming request is not secure, the user will be redirected to a secure
version of the page and the HTTP Strict Transport Security (HSTS) header will be
set.</p>
</section>
<section id="performancemetrics">
<span id="id5"></span><h3><a class="toc-backref" href="#id26" role="doc-backlink">PerformanceMetrics</a><a class="headerlink" href="#performancemetrics" title="Permalink to this heading"></a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 4.5.0.</span></p>
</div>
<p>This filter provides the pseudo-variables for performance metrics.</p>
<p>If you would like to display the total elapsed time from the moment CodeIgniter
starts to the moment right before the final output is sent to the browser,
simply place this pseudo-variable in one of your views:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nx">elapsed_time</span><span class="p">}</span>
</pre></div>
</div>
<p>If you would like to show your memory usage in your view files, use this
pseudo-variable:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nx">memory_usage</span><span class="p">}</span>
</pre></div>
</div>
<p>If you don’t need this feature, remove <code class="docutils literal notranslate"><span class="pre">'performance'</span></code> from <code class="docutils literal notranslate"><span class="pre">$required['after']</span></code>.</p>
</section>
<section id="invalidchars">
<span id="id6"></span><h3><a class="toc-backref" href="#id27" role="doc-backlink">InvalidChars</a><a class="headerlink" href="#invalidchars" title="Permalink to this heading"></a></h3>
<p>This filter prohibits user input data (<code class="docutils literal notranslate"><span class="pre">$_GET</span></code>, <code class="docutils literal notranslate"><span class="pre">$_POST</span></code>, <code class="docutils literal notranslate"><span class="pre">$_COOKIE</span></code>, <code class="docutils literal notranslate"><span class="pre">php://input</span></code>) from containing the following characters:</p>
<ul class="simple">
<li><p>invalid UTF-8 characters</p></li>
<li><p>control characters except line break and tab code</p></li>
</ul>
</section>
<section id="secureheaders">
<span id="id7"></span><h3><a class="toc-backref" href="#id28" role="doc-backlink">SecureHeaders</a><a class="headerlink" href="#secureheaders" title="Permalink to this heading"></a></h3>
<p>This filter adds HTTP response headers that your application can use to increase the security of your application.</p>
<p>If you want to customize the headers, extend <code class="docutils literal notranslate"><span class="pre">CodeIgniter\Filters\SecureHeaders</span></code> and override the <code class="docutils literal notranslate"><span class="pre">$headers</span></code> property. And change the <code class="docutils literal notranslate"><span class="pre">$aliases</span></code> property in <strong>app/Config/Filters.php</strong>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">array</span> <span class="nv">$aliases</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c1">// ...</span>
        <span class="s1">&#39;secureheaders&#39;</span> <span class="o">=&gt;</span> <span class="nx">\App\Filters\SecureHeaders</span><span class="o">::</span><span class="na">class</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you want to know about secure headers, see <a class="reference external" href="https://owasp.org/www-project-secure-headers/">OWASP Secure Headers Project</a>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="controllers.html" class="btn btn-neutral float-left" title="Controllers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="auto_routing_improved.html" class="btn btn-neutral float-right" title="Auto Routing (Improved)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2025 CodeIgniter Foundation.
      <span class="lastupdated">Last updated on Sep 04, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>